<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Parametric bootstrap method for fitted models inheriting class. — parboot • unmarked</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Parametric bootstrap method for fitted models inheriting class. — parboot" />
<meta property="og:description" content="Simulate datasets from a fitted model, refit the model, and
  generate a sampling distribution for a user-specified fit-statistic." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">unmarked</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1.9020</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rbchan/unmarked/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Parametric bootstrap method for fitted models inheriting class.</h1>
    
    <div class="hidden name"><code>parboot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulate datasets from a fitted model, refit the model, and
  generate a sampling distribution for a user-specified fit-statistic.</p>
    </div>


    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>a fitted model inheriting class "unmarkedFit"</p></td>
    </tr>
    <tr>
      <th>statistic</th>
      <td><p>a function returning a vector of fit-statistics.
    First argument must be the fitted model.
    Default is sum of squared residuals.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>number of bootstrap replicates</p></td>
    </tr>
    <tr>
      <th>report</th>
      <td><p>print fit statistic every 'report' iterations during resampling</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>set seed for reproducible bootstrap</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>logical (default = <code>TRUE</code>) indicating whether to compute 
    bootstrap on multiple cores, if present.  If <code>TRUE</code>, suppresses reporting
    of bootstrapped statistics.  Defaults to serial calculation when <code>nsim</code> &lt; 100.
    Parallel computation is likely to be slower for simple models when <code>nsim</code> &lt; ~500,
    but should speed up the bootstrap of more complicated models.</p></td>
    </tr>
    <tr>
      <th>ncores</th>
      <td><p>integer (default = one less than number of available cores) number of cores to
    use when bootstrapping in parallel.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to be passed to statistic</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function simulates datasets based upon a fitted model,
  refits the model, and evaluates a user-specified fit-statistic for each
  simulation. Comparing this sampling distribution to the observed statistic
  provides a means of evaluating goodness-of-fit or assessing uncertainty in
  a quantity of interest.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class parboot with three slots:</p>
<dt>call</dt><dd><p>parboot call</p></dd>
  <dt>t0</dt><dd><p>Numeric vector of statistics for original fitted model.</p></dd>
  <dt>t.star</dt><dd><p>nsim by length(t0) matrix of statistics for each simulation fit.</p></dd>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Richard Chandler <a href='mailto:rbchan@uga.edu'>rbchan@uga.edu</a> and Adam Smith</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='ranef-methods.html'>ranef</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>linetran</span><span class='op'>)</span>
<span class='op'>(</span><span class='va'>dbreaksLine</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>15</span>, <span class='fl'>20</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]  0  5 10 15 20</div><div class='input'><span class='va'>lengths</span> <span class='op'>&lt;-</span> <span class='va'>linetran</span><span class='op'>$</span><span class='va'>Length</span>

<span class='va'>ltUMF</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>linetran</span>, <span class='op'>{</span>
  <span class='fu'><a href='unmarkedFrameDS.html'>unmarkedFrameDS</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>dc1</span>, <span class='va'>dc2</span>, <span class='va'>dc3</span>, <span class='va'>dc4</span><span class='op'>)</span>,
  siteCovs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>Length</span>, <span class='va'>area</span>, <span class='va'>habitat</span><span class='op'>)</span>, dist.breaks <span class='op'>=</span> <span class='va'>dbreaksLine</span>,
  tlength <span class='op'>=</span> <span class='va'>lengths</span><span class='op'>*</span><span class='fl'>1000</span>, survey <span class='op'>=</span> <span class='st'>"line"</span>, unitsIn <span class='op'>=</span> <span class='st'>"m"</span><span class='op'>)</span>
    <span class='op'>}</span><span class='op'>)</span>

<span class='co'># Fit a model</span>
<span class='op'>(</span><span class='va'>fm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='distsamp.html'>distsamp</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>area</span> <span class='op'>~</span><span class='va'>habitat</span>, <span class='va'>ltUMF</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; distsamp(formula = ~area ~ habitat, data = ltUMF)
#&gt; 
#&gt; Density:
#&gt;             Estimate    SE     z P(&gt;|z|)
#&gt; (Intercept)   -0.287 0.167 -1.72  0.0852
#&gt; habitatB       0.253 0.198  1.28  0.2000
#&gt; 
#&gt; Detection:
#&gt;             Estimate    SE     z  P(&gt;|z|)
#&gt; (Intercept)     3.06 0.548  5.57 2.53e-08
#&gt; area           -0.13 0.096 -1.35 1.76e-01
#&gt; 
#&gt; AIC: 165.5482 </div><div class='input'>
<span class='co'># Function returning three fit-statistics.</span>
<span class='va'>fitstats</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>fm</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>observed</span> <span class='op'>&lt;-</span> <span class='fu'><a href='unmarkedFrame-class.html'>getY</a></span><span class='op'>(</span><span class='va'>fm</span><span class='op'>@</span><span class='va'>data</span><span class='op'>)</span>
    <span class='va'>expected</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></span><span class='op'>(</span><span class='va'>fm</span><span class='op'>)</span>
    <span class='va'>resids</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>fm</span><span class='op'>)</span>
    <span class='va'>sse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>resids</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
    <span class='va'>chisq</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>observed</span> <span class='op'>-</span> <span class='va'>expected</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>/</span> <span class='va'>expected</span><span class='op'>)</span>
    <span class='va'>freeTuke</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>observed</span><span class='op'>)</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>expected</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
    <span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>SSE<span class='op'>=</span><span class='va'>sse</span>, Chisq<span class='op'>=</span><span class='va'>chisq</span>, freemanTukey<span class='op'>=</span><span class='va'>freeTuke</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>out</span><span class='op'>)</span>
    <span class='op'>}</span>

<span class='op'>(</span><span class='va'>pb</span> <span class='op'>&lt;-</span> <span class='fu'>parboot</span><span class='op'>(</span><span class='va'>fm</span>, <span class='va'>fitstats</span>, nsim<span class='op'>=</span><span class='fl'>25</span>, report<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; t0 = 113.6884 53.6492 23.19506 
#&gt; iter 1 :  51.76656 29.33734 12.13766 
#&gt; iter 2 :  86.40796 47.36944 20.79663 
#&gt; iter 3 :  101.0376 43.93918 17.6049 
#&gt; iter 4 :  119.055 46.61317 18.78843 
#&gt; iter 5 :  95.61046 46.82708 16.04149 
#&gt; iter 6 :  117.9119 52.39022 17.77974 
#&gt; iter 7 :  97.09245 48.89117 23.22477 
#&gt; iter 8 :  132.7958 52.14974 17.68474 
#&gt; iter 9 :  107.5958 46.70377 17.23415 
#&gt; iter 10 :  73.06662 29.29117 11.18831 
#&gt; iter 11 :  75.30468 37.47914 14.67528 
#&gt; iter 12 :  115.3185 50.47065 22.94304 
#&gt; iter 13 :  81.07769 40.60462 15.79172 
#&gt; iter 14 :  112.6747 38.32514 13.14837 
#&gt; iter 15 :  67.64564 45.55177 13.71304 
#&gt; iter 16 :  42.77671 29.09115 13.11265 
#&gt; iter 17 :  80.65436 33.16117 11.87273 
#&gt; iter 18 :  154.4764 60.23054 25.19856 
#&gt; iter 19 :  104.4421 52.93641 23.86797 
#&gt; iter 20 :  58.27236 29.40857 11.41073 
#&gt; iter 21 :  100.7842 52.87954 18.40903 
#&gt; iter 22 :  81.58062 41.29601 15.80306 
#&gt; iter 23 :  118.4719 59.95035 21.71737 
#&gt; iter 24 :  80.72755 43.11816 17.27023 
#&gt; iter 25 :  104.6474 58.91896 17.89389 </div><div class='output co'>#&gt; 
#&gt; Call: parboot(object = fm, statistic = fitstats, nsim = 25, report = 1)
#&gt; 
#&gt; Parametric Bootstrap Statistics:
#&gt;                 t0 mean(t0 - t_B) StdDev(t0 - t_B) Pr(t_B &gt; t0)
#&gt; SSE          113.7          19.24            25.96        0.231
#&gt; Chisq         53.6           8.97             9.58        0.115
#&gt; freemanTukey  23.2           6.02             4.07        0.115
#&gt; 
#&gt; t_B quantiles:
#&gt;              0% 2.5% 25% 50% 75% 97.5% 100%
#&gt; SSE          43   48  81  97 113   141  154
#&gt; Chisq        29   29  38  47  52    60   60
#&gt; freemanTukey 11   11  14  17  19    24   25
#&gt; 
#&gt; t0 = Original statistic computed from data
#&gt; t_B = Vector of bootstrap samples
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>pb</span>, main<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span>
</div><div class='img'><img src='parboot-1.png' alt='' width='700' height='433' /></div><div class='img'><img src='parboot-2.png' alt='' width='700' height='433' /></div><div class='img'><img src='parboot-3.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'># Finite-sample inference for a derived parameter.</span>
<span class='co'># Population size in sampled area</span>

<span class='va'>Nhat</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>fm</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='unmarkedRanef-class.html'>bup</a></span><span class='op'>(</span><span class='fu'><a href='ranef-methods.html'>ranef</a></span><span class='op'>(</span><span class='va'>fm</span>, K<span class='op'>=</span><span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
    <span class='op'>}</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>345</span><span class='op'>)</span>
<span class='op'>(</span><span class='va'>pb.N</span> <span class='op'>&lt;-</span> <span class='fu'>parboot</span><span class='op'>(</span><span class='va'>fm</span>, <span class='va'>Nhat</span>, nsim<span class='op'>=</span><span class='fl'>25</span>, report<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; t0 = 162.2135 
#&gt; iter 5 :  151.6393 
#&gt; iter 10 :  183.7412 
#&gt; iter 15 :  156.2485 
#&gt; iter 20 :  179.1255 
#&gt; iter 25 :  135.8852 </div><div class='output co'>#&gt; 
#&gt; Call: parboot(object = fm, statistic = Nhat, nsim = 25, report = 5)
#&gt; 
#&gt; Parametric Bootstrap Statistics:
#&gt;    t0 mean(t0 - t_B) StdDev(t0 - t_B) Pr(t_B &gt; t0)
#&gt; 1 162          0.701             15.9        0.462
#&gt; 
#&gt; t_B quantiles:
#&gt;      0% 2.5% 25% 50% 75% 97.5% 100%
#&gt; t*1 129  132 151 162 174   184  184
#&gt; 
#&gt; t0 = Original statistic computed from data
#&gt; t_B = Vector of bootstrap samples
#&gt; </div><div class='input'>
<span class='co'># Compare to empirical Bayes confidence intervals</span>
<span class='fu'><a href='https://rdrr.io/pkg/raster/man/rowSums.html'>colSums</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='fu'><a href='ranef-methods.html'>ranef</a></span><span class='op'>(</span><span class='va'>fm</span>, K<span class='op'>=</span><span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  2.5% 97.5% 
#&gt;   117   218 </div><div class='input'>


</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://chandlerlab.uga.edu/richard-chandler-phd/'>Richard Chandler</a>, <a href='https://kenkellner.com'>Ken Kellner</a>, Ian Fiske, David Miller, Andy Royle, Jeff Hostetler, Rebecca Hutchinson, Adam Smith.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


