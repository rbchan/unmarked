<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Power Analysis in unmarked • unmarked</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Power Analysis in unmarked">
<meta property="og:description" content="unmarked">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">unmarked</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/unmarked.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cap-recap.html">Modeling variation in abundance using capture-recapture data</a>
    </li>
    <li>
      <a href="../articles/colext.html">Dynamic occupancy models in unmarked</a>
    </li>
    <li>
      <a href="../articles/distsamp.html">Distance sampling analysis in unmarked</a>
    </li>
    <li>
      <a href="../articles/powerAnalysis.html">Power Analysis in unmarked</a>
    </li>
    <li>
      <a href="../articles/simulate.html">Simulating datasets</a>
    </li>
    <li>
      <a href="../articles/spp-dist.html">Modeling and mapping species distributions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rbchan/unmarked/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Power Analysis in unmarked</h1>
                        <h4 class="author">Ken Kellner</h4>
            
            <h4 class="date">September 3, 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rbchan/unmarked/blob/master/vignettes/powerAnalysis.Rmd"><code>vignettes/powerAnalysis.Rmd</code></a></small>
      <div class="hidden name"><code>powerAnalysis.Rmd</code></div>

    </div>

    
    
<div id="hypothesis-testing" class="section level1">
<h1 class="hasAnchor">
<a href="#hypothesis-testing" class="anchor"></a>Hypothesis Testing</h1>
<p>For many analyses in <code>unmarked</code>, a primary goal is to determine if a certain covariate affects the state or detection process. For example, we may want to determine if elevation has an effect on probability of site occupancy, or if wind speed has an effect on detection. We can formulate this idea as set of statistical hypotheses: the null hypothesis (<span class="math inline">\(H_0\)</span>) and the alternative hypothesis (<span class="math inline">\(H_a\)</span>):</p>
<ul>
<li>
<span class="math inline">\(H_0\)</span>: There is no effect of elevation on occupancy</li>
<li>
<span class="math inline">\(H_a\)</span>: Elevation has an effect on occupancy</li>
</ul>
<p>In order to test these hypotheses, we must collected appropriate data, perhaps by sampling a series of sites at varying elevation for the presence of the species. We can then fit a model in <code>unmarked</code>, specifying in the formula that we are interested in estimating the effect of elevation on occupancy. For example, here is a simple model fit to the <code>crossbill</code> presence-absence dataset included with <code>unmarked</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://groups.google.com/d/forum/unmarked">unmarked</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">crossbill</span><span class="op">)</span>

<span class="va">umf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/unmarkedFrameOccu.html">unmarkedFrameOccu</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">crossbill</span><span class="op">[</span>,<span class="fl">11</span><span class="op">:</span><span class="fl">13</span><span class="op">]</span>, 
                         siteCovs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>elev<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/scale.html">scale</a></span><span class="op">(</span><span class="va">crossbill</span><span class="op">$</span><span class="va">ele</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">(</span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/occu.html">occu</a></span><span class="op">(</span><span class="op">~</span><span class="fl">1</span><span class="op">~</span><span class="va">elev</span>, <span class="va">umf</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>## 
## Call:
## occu(formula = ~1 ~ elev, data = umf)
## 
## Occupancy:
##             Estimate    SE     z  P(&gt;|z|)
## (Intercept)   -1.223 0.168 -7.27 3.61e-13
## elev           0.594 0.166  3.59 3.35e-04
## 
## Detection:
##  Estimate    SE    z P(&gt;|z|)
##     0.326 0.186 1.75  0.0798
## 
## AIC: 480.8533</code></pre>
<div id="wald-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#wald-tests" class="anchor"></a>Wald tests</h2>
<p>In the code{unmarked} output, we obtain an estimate (<span class="math inline">\(\hat{\theta}\)</span>) of the regression coefficient associated with elevation (<code>elev</code>) along with its standard error. Our null hypothesis is that elevation has no effect on occupancy, i.e. <span class="math inline">\(\theta_0 = 0\)</span>. With this information, we can conduct a statistical hypothesis test called a Wald test: <span class="math display">\[
\sqrt{W} = \frac{(\hat{\theta} -\theta_0)}{se(\hat{\theta})}
\]</span></p>
<p>Or simplified: <span class="math display">\[
\sqrt{W} = \frac{(0.5939 - 0)}{0.1656} = 3.59
\]</span></p>
<p>It turns out that the square root of the Wald statistic, <span class="math inline">\(\sqrt{W}\)</span>, follows a standard normal distribution. Thus, we can calculate the probability that our observed statistic, <span class="math inline">\(\sqrt{W} = 3.59\)</span>, occurred by chance assuming that the null hypothesis <span class="math inline">\(\theta = 0\)</span> is true. In R, for a two-tailed test, this can be calculated as:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="va">z</span> <span class="op">=</span> <span class="va">sqrt_w</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="../reference/SE-methods.html">SE</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
<span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></pre></div>
<pre><code>##    psi(elev) 
## 0.0003350055</code></pre>
<p>This is the p-value. These values we calculated manually match the results that <code>unmarked</code> gave us in the summary output.</p>
</div>
<div id="making-a-conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#making-a-conclusion" class="anchor"></a>Making a conclusion</h2>
<p>Before conducting our study, we should have defined a threshold p-value (the significance level or <span class="math inline">\(\alpha\)</span>) below which we reject the null hypothesis. Traditionally, <span class="math inline">\(\alpha = 0.05\)</span>. Our calculated p-value is less than <span class="math inline">\(\alpha\)</span>, so we reject the null hypothesis that elevation has no effect on occupancy.</p>
</div>
<div id="types-of-error" class="section level2">
<h2 class="hasAnchor">
<a href="#types-of-error" class="anchor"></a>Types of error</h2>
<p>There are two types of errors that we could be making at this point:</p>
<ol style="list-style-type: decimal">
<li>Type I error: We reject the null hypothesis when in fact it is true. Type I error is conceptually the same as <span class="math inline">\(\alpha\)</span>. If we set <span class="math inline">\(\alpha\)</span> larger, we have a greater chance of Type I error.</li>
<li>Type II error: We fail to reject the null hypothesis when in fact it is false. This can occur, for example, if we did not have enough data to detect an effect.</li>
</ol>
<p>In this vignette, we are most concerned with Type II error. How do we know we have enough data to detect if a covariate has a certain effect? To answer this question we can use power analysis.</p>
</div>
</div>
<div id="power-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#power-analysis" class="anchor"></a>Power Analysis</h1>
<div id="overview-of-power-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-of-power-analysis" class="anchor"></a>Overview of power analysis</h2>
<p>Statistical power is defined as 1 - Type II error. So more power means less chance of false negatives, i.e., less chance of failing to reject the null hypothesis when it is false. Statistical power depends on three other pieces of information:</p>
<ol style="list-style-type: decimal">
<li>The effect size: the magnitude of the effect of the covariate. The larger the effect, the more power we have to detect it.</li>
<li>The sample size: how many sites or surveys we’ve done. The more samples, the more power we have.</li>
<li>The significance level, <span class="math inline">\(\alpha\)</span>. The smaller we make <span class="math inline">\(\alpha\)</span>, the less power we have: thus there is a tradeoff between Type I and Type II error.</li>
</ol>
<p>Of the three factors (2) is the one that makes the most sense for researchers to manipulate in order to increase power. However, increasing the sample size requires additional effort and money - so how large does it need to be?</p>
<p>For many statistical models, mathematical formulas have been developed so that power can be calculated for any combination of values for factors 1-3 above. This is not true for most occupancy and abundance models available in <code>unmarked</code> (but see <span class="citation">Guillera-Arroita and Lahoz-Monfort (2012)</span> for one example with occupancy models). Thus, <code>unmarked</code> uses a simulation-based approach for estimating power under various combinations of values for effect size, sample size, and significance level.</p>
</div>
<div id="power-analysis-inputs-in-unmarked" class="section level2">
<h2 class="hasAnchor">
<a href="#power-analysis-inputs-in-unmarked" class="anchor"></a>Power analysis inputs in unmarked</h2>
<p>When conducting power analysis, <code>unmarked</code> needs three pieces of information corresponding to 1-3 above. Of these, (1) the effect size and (3) the significance level are easy to set depending on our hypotheses and desired Type I error. The sample size (2) is trickier: it isn’t enough to just provide the number of sites, since datasets in <code>unmarked</code> also require a variety of other information such as number of surveys per site, number of distance bins, or number of primary periods. Thus, power analysis in <code>unmarked</code> requires a complete dataset in the form of an appropriate <code>unmarkedFrame</code>.</p>
<p>In some cases, we may want to calculate power using an already collected dataset. Importantly, this step must be done  running our final analysis. If power analysis is done after the final model is fit, and the effect sizes are defined based on what was observed in that fitted model, we have done what is called a <em>post-hoc</em> power analysis, which is a bad idea (see <a href="https://statmodeling.stat.columbia.edu/2018/09/24/dont-calculate-post-hoc-power-using-observed-estimate-effect-size/">this post</a> for an example of why this is so bad). In most cases, the real value of power analysis comes before we actually go collect any data, because it helps us decide how much data to collect. But how to get an <code>unmarkedFrame</code> of data before we’ve done our study? Once again the solution is simulation: <code>unmarked</code> provides a set of tools for simulating datasets for any of its supported model types.</p>
</div>
<div id="simulating-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-datasets" class="anchor"></a>Simulating datasets</h2>
<p>To simulate a dataset for a given <code>unmarked</code> model, we need at a minimum four pieces of information:</p>
<ol style="list-style-type: decimal">
<li>The type of model (the name of the corresponding fitting function)</li>
<li>The covariates affecting each submodel, such as occupancy or detection (supplied as formulas)</li>
<li>The effect size for each intercept and covariate</li>
<li>Study design parameters such as number of sites and number of surveys</li>
</ol>
<p>For example, suppose we want to simulate an occupancy dataset (<code>"occu"</code>) in which site occupancy is affected by elevation. The first step is to organize the model structure as a list of formulas, one per submodel. This list must be named in a specific way depending on the model type. To get the required names for a given model, fit an example of that model (the documentation should have one) and call <code><a href="https://rdrr.io/pkg/raster/man/names.html">names(model)</a></code>. A single-season occupancy model requires a list with two named components: <code>state</code> and <code>det</code>. We supply a formula for each including an effect of elevation on occupancy (note we could name this whatever we want, here we call it <code>elev</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="va">forms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>state<span class="op">=</span><span class="op">~</span><span class="va">elev</span>, det<span class="op">=</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span></pre></div>
<p>Next we must tell <code>unmarked</code> what the values for the intercept and regression coefficients in each submodel should be. Once again, this is a named list, one element for each submodel. Within each element we need a named vector with names that match the covariates in our list of formulas above. Note also that each must include a value for the intercept term (this can be named <code>intercept</code> or <code>Intercept</code>). If we are not sure exactly how to structure this list, just skip it for now: <code>unmarked</code> can generate a template for us to fill in later.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="va">coefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>state<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>intercept<span class="op">=</span><span class="fl">0</span>, elev<span class="op">=</span><span class="op">-</span><span class="fl">0.4</span><span class="op">)</span>, det<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>intercept<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></pre></div>
<p>Finally, we need to give <code>unmarked</code> information about the study design. This is pretty simple: we just need a list containing values for <code>M</code>, the number of sites, and <code>J</code> the number of surveys per site. For models with multiple primary periods, we’d also need a value of <code>T</code>, the number of primary periods.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>M<span class="op">=</span><span class="fl">300</span>, J<span class="op">=</span><span class="fl">8</span><span class="op">)</span> <span class="co"># 300 sites, 8 occasions per site</span></pre></div>
<p>We’re now ready to simulate a dataset. To do this we use the <code>simulate</code> function, providing as arguments the name of the model <code>"occu"</code> and the three lists we constructed above. Actually, first, let’s not supply the <code>coefs</code> list, to show how <code>unmarked</code> will generate a template for us to use:</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/stats/simulate.html">simulate</a></span><span class="op">(</span><span class="st">"occu"</span>, formulas<span class="op">=</span><span class="va">forms</span>, design<span class="op">=</span><span class="va">design</span><span class="op">)</span></pre></div>
<pre><code>## coefs argument should be a named list of named vectors, with the following structure
##         (replacing 0s with your desired coefficient values):
## 
## $state
## intercept      elev 
##         0         0 
## 
## $det
## intercept 
##         0 
## 
## Error : Supply coefs argument as specified above</code></pre>
<p>Once we have our covariates set up properly, add them to the function call:</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="va">occu_umf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html">simulate</a></span><span class="op">(</span><span class="st">"occu"</span>, formulas<span class="op">=</span><span class="va">forms</span>, coefs<span class="op">=</span><span class="va">coefs</span>, design<span class="op">=</span><span class="va">design</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">occu_umf</span><span class="op">)</span></pre></div>
<pre><code>## Data frame representation of unmarkedFrame object.
##    y.1 y.2 y.3 y.4 y.5 y.6 y.7 y.8       elev
## 1    0   0   0   0   0   0   0   0 -0.7152422
## 2    0   0   0   0   0   0   0   0 -0.7526890
## 3    0   0   0   0   1   0   1   0 -0.9385387
## 4    0   0   0   0   0   0   0   0 -1.0525133
## 5    1   0   0   0   0   0   1   0 -0.4371595
## 6    0   1   0   1   1   0   0   0  0.3311792
## 7    1   1   1   0   0   0   0   0 -2.0142105
## 8    0   0   0   0   0   0   0   0  0.2119804
## 9    1   0   0   1   0   1   0   0  1.2366750
## 10   0   0   0   0   0   0   0   0  2.0375740</code></pre>
<p><code>unmarked</code> has generated a presence-absence dataset as well as values for covariate <code>elev</code>.</p>
<div id="customizing-the-covariates" class="section level3">
<h3 class="hasAnchor">
<a href="#customizing-the-covariates" class="anchor"></a>Customizing the covariates</h3>
<p>By default, a covariate will be continuous and come from a standard normal distribution. However, we can control this using the <code>guide</code> argument. For example, suppose we want elevation to have a mean of 2 and a standard deviation of 0.5, and we also want a categorical covariate called <code>landcover</code>. The corresponding formulas and list to supply to <code>guide</code> would look like this:</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="va">forms2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>state<span class="op">=</span><span class="op">~</span><span class="va">elev</span><span class="op">+</span><span class="va">landcover</span>, det<span class="op">=</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span>
<span class="va">guide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>landcover<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"forest"</span>,<span class="st">"grass"</span><span class="op">)</span><span class="op">)</span>, <span class="co"># landcover is factor </span>
              elev<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>dist<span class="op">=</span><span class="va">rnorm</span>, mean<span class="op">=</span><span class="fl">2</span>, sd<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="co"># custom distribution</span></pre></div>
<p>We’d also need an updated <code>coefs</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="va">coefs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>state<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>intercept<span class="op">=</span><span class="fl">0</span>, elev<span class="op">=</span><span class="op">-</span><span class="fl">0.4</span>, landcovergrass<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>, det<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>intercept<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/simulate.html">simulate</a></span><span class="op">(</span><span class="st">"occu"</span>, formulas<span class="op">=</span><span class="va">forms2</span>, coefs<span class="op">=</span><span class="va">coefs2</span>, design<span class="op">=</span><span class="va">design</span>, guide<span class="op">=</span><span class="va">guide</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>## Data frame representation of unmarkedFrame object.
##    y.1 y.2 y.3 y.4 y.5 y.6 y.7 y.8     elev landcover
## 1    0   0   0   0   0   0   0   0 2.063074    forest
## 2    0   0   0   0   0   0   0   0 2.236400    forest
## 3    0   0   0   0   0   0   0   0 1.829623     grass
## 4    0   0   0   0   0   0   0   0 1.879105    forest
## 5    0   0   0   0   0   0   0   0 2.689377     grass
## 6    0   0   0   0   0   0   0   0 1.830558    forest
## 7    0   0   0   0   0   0   0   0 2.010068    forest
## 8    0   0   0   0   0   0   0   0 2.188481     grass
## 9    1   0   1   1   1   0   0   0 1.784138    forest
## 10   0   0   0   0   0   0   0   0 2.979532     grass</code></pre>
<p>Our output dataset now includes a new categorical covariate, and the elevation values are adjusted.</p>
</div>
<div id="models-that-require-more-information" class="section level3">
<h3 class="hasAnchor">
<a href="#models-that-require-more-information" class="anchor"></a>Models that require more information</h3>
<p>More complex models might require more information for simulation, such as the distribution to use for abundance with <code>pcount</code>. This information is simply added as additional arguments to <code>simulate</code>. For example, we can simulate a <code>pcount</code> dataset using the negative binomial (<code>"NB"</code>) distribution. The negative binomial has an additional parameter to estimate (<code>alpha</code>) so we must also add an element to <code>coefs</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="va">coefs</span><span class="op">$</span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/simulate.html">simulate</a></span><span class="op">(</span><span class="st">"pcount"</span>, formulas<span class="op">=</span><span class="va">forms</span>, coefs<span class="op">=</span><span class="va">coefs</span>, design<span class="op">=</span><span class="va">design</span>, mixture<span class="op">=</span><span class="st">"NB"</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>## Data frame representation of unmarkedFrame object.
##    y.1 y.2 y.3 y.4 y.5 y.6 y.7 y.8        elev
## 1    0   0   0   0   0   0   0   0 -1.42329439
## 2    0   0   0   0   0   0   0   0  1.02230366
## 3    0   1   1   0   1   0   0   0  0.68781508
## 4    0   0   0   0   0   0   0   0 -0.30745489
## 5    0   0   1   0   0   1   0   1 -0.01974906
## 6    0   1   1   1   0   0   1   0  0.48839839
## 7    0   0   0   0   0   0   0   0  0.66050081
## 8    0   1   0   1   1   1   0   1 -1.71404333
## 9    0   0   0   0   0   0   0   0  1.45885698
## 10   0   0   0   0   0   0   0   0 -1.40789548</code></pre>
</div>
</div>
<div id="conducting-a-power-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#conducting-a-power-analysis" class="anchor"></a>Conducting a power analysis</h2>
<p>Power analyses are conducted with the <code>powerAnalysis</code> function. A <code>powerAnalysis</code> power analysis depends on the input dataset, as well as the covariates of interest and other settings depending on the model (e.g. the distribution used in an N-mixture model or the detection key function in a distance sampling analysis). The easiest way combine all this information and send it to <code>powerAnalysis</code> is to actually fit a model with all the correct settings and our simulated dataset and send <em>that</em> to <code>powerAnalysis</code>. This has the added benefit that it checks to make sure we have all the required information for a valid model. Note that the actual parameter estimates from this model template don’t matter - they aren’t used in the power analysis. Thus, there are two required arguments to <code>powerAnalysis</code>: a fitted model template, and a list of effect sizes.</p>
<p>The first step is to fit a model:</p>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="va">template_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/occu.html">occu</a></span><span class="op">(</span><span class="op">~</span><span class="fl">1</span><span class="op">~</span><span class="va">elev</span>, <span class="va">occu_umf</span><span class="op">)</span></pre></div>
<p>If we run <code>powerAnalysis</code> on <code>template_model</code> with no other arguments, <code>unmarked</code> will again give us a template for the list of effect sizes, which looks exactly like the one for simulation above.</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="fu"><a href="../reference/powerAnalysis.html">powerAnalysis</a></span><span class="op">(</span><span class="va">template_model</span><span class="op">)</span></pre></div>
<pre><code>## coefs argument should be a named list of named vectors, with the following structure
##         (replacing 0s with your desired coefficient values):
## 
## $state
## intercept      elev 
##         0         0 
## 
## $det
## intercept 
##         0 
## 
## Error : Supply coefs argument as specified above</code></pre>
<p>We will set our desired effect sizes to match what we used for simulation:</p>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="va">effect_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>state<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>intercept<span class="op">=</span><span class="fl">0</span>, elev<span class="op">=</span><span class="op">-</span><span class="fl">0.4</span><span class="op">)</span>, det<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>intercept<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></pre></div>
<p>It is also possible to set the significance level <code>alpha</code>; the default is 0.05. We now have all the required information to conduct the power analysis. Remember, <code>unmarked</code> does this by simulation, so you will see a progress bar as <code>unmarked</code> conducts simulations. You can control how many with the <code>nsim</code> argument; we’ll set <code>nsim=20</code> just to speed things up, but normally you should use more.</p>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="op">(</span><span class="va">pa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/powerAnalysis.html">powerAnalysis</a></span><span class="op">(</span><span class="va">template_model</span>, coefs<span class="op">=</span><span class="va">effect_sizes</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, nsim<span class="op">=</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>## 
## Model:
## occu(formula = ~1 ~ elev, data = occu_umf)
## 
## Power Statistics:
##  Submodel   Parameter Effect Null Power
##     state (Intercept)    0.0    0  0.00
##     state        elev   -0.4    0  0.95
##       det (Intercept)    0.0    0  0.00</code></pre>
<p>The result is an object <code>pa</code> of class <code>unmarkedPower</code>. If you look at <code>pa</code> in the console you will get a summary of power for each parameter in the model. The summary includes the submodel, parameter name, supplied effect size, null hypothesis, and the calculated power based on simulation. By default the null for each parameter is 0, you can change this by supplying a list to the <code>nulls</code> argument with the same structure as <code>coefs</code>.</p>
<p>We have power = 0.95 for the effect of elevation on occupancy probability. This power is calculated by simulating a bunch of datasets based on the template model and supplied effect sizes, fitting a model to each simulated dataset, and then calculating the proportion of these models for which an effect of the covariate would have been detected at the given value of <code>alpha</code>. You can see the raw results from each simulated model with</p>
<div class="sourceCode" id="cb24"><pre class="downlit">
<span class="va">pa</span><span class="op">@</span><span class="va">estimates</span></pre></div>
<div id="varying-the-sample-size" class="section level3">
<h3 class="hasAnchor">
<a href="#varying-the-sample-size" class="anchor"></a>Varying the sample size</h3>
<p>One approach to determining how sample size affects power for our model is to simulate a range of <code>unmarkedFrames</code> with varying number of sites, observations, etc. and do a power analysis for each. However <code>powerAnalysis</code> also has a argument <code>design</code> which can help do this automatically.</p>
<p>The <code>design</code> argument will subsample within the original data to generate datasets which are smaller or larger than the original, and conduct power analyses for each scenario. For example, to test power for a dataset with only 50 sites and 3 sample occasions at each:</p>
<div class="sourceCode" id="cb25"><pre class="downlit">
<span class="co"># 50 sites and 3 obs per site</span>
<span class="op">(</span><span class="va">pa2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/powerAnalysis.html">powerAnalysis</a></span><span class="op">(</span><span class="va">template_model</span>, <span class="va">effect_sizes</span>, design<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>M<span class="op">=</span><span class="fl">50</span>, J<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, nsim<span class="op">=</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>## 
## Model:
## occu(formula = ~1 ~ elev, data = occu_umf)
## 
## Power Statistics:
##  Submodel   Parameter Effect Null Power
##     state (Intercept)    0.0    0   0.0
##     state        elev   -0.4    0   0.1
##       det (Intercept)    0.0    0   0.0</code></pre>
<p>With fewer sites and sampling occasions, our power to detect the elevation effect is reduced.</p>
<p>You can also get a larger number of sites via sampling the original sites with replacement:</p>
<div class="sourceCode" id="cb27"><pre class="downlit">
<span class="op">(</span><span class="va">pa3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/powerAnalysis.html">powerAnalysis</a></span><span class="op">(</span><span class="va">template_model</span>, <span class="va">effect_sizes</span>, design<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>M<span class="op">=</span><span class="fl">400</span>, J<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, nsim<span class="op">=</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>## 
## Model:
## occu(formula = ~1 ~ elev, data = occu_umf)
## 
## Power Statistics:
##  Submodel   Parameter Effect Null Power
##     state (Intercept)    0.0    0  0.00
##     state        elev   -0.4    0  0.95
##       det (Intercept)    0.0    0  0.00</code></pre>
</div>
<div id="combining-unmarkedpower-objects" class="section level3">
<h3 class="hasAnchor">
<a href="#combining-unmarkedpower-objects" class="anchor"></a>Combining unmarkedPower objects</h3>
<p>The <code>unmarkedPowerList</code> function creates a <code>unmarkedPowerList</code> object for holding multiple <code>unmarkedPower</code> objects so they can be easily compared. The summary of an <code>unmarkedPowerList</code> is a <code>data.frame</code> with all the outputs shown together, including relevant sample sizes.</p>
<div class="sourceCode" id="cb29"><pre class="downlit">
<span class="fu"><a href="../reference/unmarkedPowerList.html">unmarkedPowerList</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">pa</span>, <span class="va">pa2</span>, <span class="va">pa3</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>##     M T J Submodel   Parameter Effect Null Power
## 1 300 1 8    state (Intercept)    0.0    0  0.00
## 2 300 1 8    state        elev   -0.4    0  0.95
## 3 300 1 8      det (Intercept)    0.0    0  0.00
## 4  50 1 3    state (Intercept)    0.0    0  0.00
## 5  50 1 3    state        elev   -0.4    0  0.10
## 6  50 1 3      det (Intercept)    0.0    0  0.00
## 7 400 1 4    state (Intercept)    0.0    0  0.00
## 8 400 1 4    state        elev   -0.4    0  0.95
## 9 400 1 4      det (Intercept)    0.0    0  0.00</code></pre>
<p>We can also create an <code>unmarkedPowerList</code> by providing a template model and a range of design scenarios in the <code>design</code> argument. A power analysis will be run for each scenario (sampling the original dataset as shown above) and the results combined.</p>
<div class="sourceCode" id="cb31"><pre class="downlit">
<span class="va">scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>M<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">200</span>,<span class="fl">400</span><span class="op">)</span>,
                         J<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/unmarkedPowerList.html">unmarkedPowerList</a></span><span class="op">(</span><span class="va">template_model</span>, <span class="va">effect_sizes</span>, design<span class="op">=</span><span class="va">scenarios</span>, nsim<span class="op">=</span><span class="fl">20</span><span class="op">)</span></pre></div>
<pre><code>## M = 50, J = 3
## M = 200, J = 3
## M = 400, J = 3
## M = 50, J = 5
## M = 200, J = 5
## M = 400, J = 5
## M = 50, J = 8
## M = 200, J = 8
## M = 400, J = 8</code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">pl</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>##     M T J Submodel   Parameter Effect Null Power
## 1  50 1 3    state (Intercept)    0.0    0  0.00
## 2  50 1 3    state        elev   -0.4    0  0.05
## 3  50 1 3      det (Intercept)    0.0    0  0.00
## 4 200 1 3    state (Intercept)    0.0    0  0.00
## 5 200 1 3    state        elev   -0.4    0  0.70
## 6 200 1 3      det (Intercept)    0.0    0  0.00</code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">pl</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>##      M T J Submodel   Parameter Effect Null Power
## 22 200 1 8    state (Intercept)    0.0    0   0.0
## 23 200 1 8    state        elev   -0.4    0   0.7
## 24 200 1 8      det (Intercept)    0.0    0   0.0
## 25 400 1 8    state (Intercept)    0.0    0   0.0
## 26 400 1 8    state        elev   -0.4    0   1.0
## 27 400 1 8      det (Intercept)    0.0    0   0.0</code></pre>
<p>There is a built-in <code>plot</code> method for <code>unmarkedPowerList</code>. You can specify a target power on the plot to the <code>power</code> argument. You also need to specify the parameter of interest (<code>"elev"</code>).</p>
<div class="sourceCode" id="cb37"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">pl</span>, power<span class="op">=</span><span class="fl">0.8</span>, param<span class="op">=</span><span class="st">"elev"</span><span class="op">)</span></pre></div>
<p><img src="powerAnalysis_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
</div>
</div>
</div>
<div id="conclusion" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h1>
<p>Power analysis is an important step in the research process that is often overlooked in studies of animal abundance and occurrence. Getting an estimate of the sample size required to detect a particular effect can help with efficient data collection and set expectations for what covariate relationships might be possible to detect. The power analysis tools in <code>unmarked</code> should help make this part of the research process quick and easy for researchers as the begin to develop study designs.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Guillera_2012">
<p>Guillera-Arroita, G., and J. J. Lahoz-Monfort. 2012. Designing studies to detect differences in species occupancy: Power analysis under imperfect detection. Methods in Ecology and Evolution 3:860–869.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://chandlerlab.uga.edu/richard-chandler-phd/">Richard Chandler</a>, <a href="https://kenkellner.com">Ken Kellner</a>, Ian Fiske, David Miller, Andy Royle, Jeff Hostetler, Rebecca Hutchinson, Adam Smith.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
