<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit the MacKenzie et al. (2002) Occupancy Model — occu • unmarked</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fit the MacKenzie et al. (2002) Occupancy Model — occu" />
<meta property="og:description" content="This function fits the single season occupancy model of MacKenzie et al (2002)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">unmarked</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1.9020</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rbchan/unmarked/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit the MacKenzie et al. (2002) Occupancy Model</h1>
    
    <div class="hidden name"><code>occu.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function fits the single season occupancy model of MacKenzie et al (2002).</p>
    </div>

    <pre class="usage"><span class='fu'>occu</span><span class='op'>(</span><span class='va'>formula</span>, <span class='va'>data</span>, knownOcc<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>, linkPsi<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"logit"</span>, <span class='st'>"cloglog"</span><span class='op'>)</span>,
            <span class='va'>starts</span>, method<span class='op'>=</span><span class='st'>"BFGS"</span>, se<span class='op'>=</span><span class='cn'>TRUE</span>, engine<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"C"</span>, <span class='st'>"R"</span>, <span class='st'>"TMB"</span><span class='op'>)</span>,
            threads <span class='op'>=</span> <span class='fl'>1</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>Double right-hand side formula describing covariates of
        detection and occupancy in that order.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>An <code><a href='unmarkedFrameOccu.html'>unmarkedFrameOccu</a></code> object</p></td>
    </tr>
    <tr>
      <th>knownOcc</th>
      <td><p>Vector of sites that are known to be occupied. These
    should be supplied as row numbers of the y matrix, eg, c(3,8) if
    sites 3 and 8 were known to be occupied a priori.</p></td>
    </tr>
    <tr>
      <th>linkPsi</th>
      <td><p>Link function for the occupancy model. Options are  
      <code>"logit"</code> for the standard occupancy model or <code>"cloglog"</code> 
      for the complimentary log-log link, which relates occupancy
      to site-level abundance. See details.</p></td>
    </tr>
    <tr>
      <th>starts</th>
      <td><p>Vector of parameter starting values.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Optimization method used by <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code>.</p></td>
    </tr>
    <tr>
      <th>se</th>
      <td><p>Logical specifying whether or not to compute standard
      errors.</p></td>
    </tr>
    <tr>
      <th>engine</th>
      <td><p>Code to use for optimization. Either "C" for fast C++ code,
      "R" for native R code, or "TMB" for Template Model Builder. "TMB" is
      used automatically if your formula contains random effects.</p></td>
    </tr>
    <tr>
      <th>threads</th>
      <td><p>Set the number of threads to use for optimization in C++, if
      OpenMP is available on your system. Increasing the number of threads
      may speed up optimization in some cases by running the likelihood 
      calculation in parallel. If <code>threads=1</code> (the default), OpenMP is disabled.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to optim, such as lower and upper
      bounds</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    

<p>See <code><a href='unmarkedFrame.html'>unmarkedFrame</a></code> and <code><a href='unmarkedFrameOccu.html'>unmarkedFrameOccu</a></code> for a
description of how to supply data to the <code>data</code> argument.</p>
<p><code>occu</code> fits the standard occupancy model based on zero-inflated
binomial models (MacKenzie et al. 2006, Royle and Dorazio
2008).  The occupancy state process (\(z_i\)) of site \(i\) is
modeled as</p>
<p>$$z_i \sim Bernoulli(\psi_i)$$</p>
<p>The observation process is modeled as</p>
<p>$$y_{ij}|z_i \sim Bernoulli(z_i p_{ij})$$</p>
<p>By default, covariates of \(\psi_i\) and \(p_{ij}\) are modeled
using the logit link according to the <code>formula</code> argument.  The formula is a double right-hand sided formula
like <code>~ detform ~ occform</code> where <code>detform</code> is a formula for the detection process and <code>occform</code> is a
formula for the partially observed occupancy state.  See <a href='https://rdrr.io/r/stats/formula.html'>formula</a> for details on constructing model formulae
in <span style="R">R</span>.</p>
<p>When <code>linkPsi = "cloglog"</code>, the complimentary log-log link 
function is used for \(psi\) instead of the logit link. The cloglog link
relates occupancy probability to the intensity parameter of an underlying
Poisson process (Kery and Royle 2016). Thus, if abundance at a site is 
can be modeled as \(N_i ~ Poisson(\lambda_i)\), where 
\(log(\lambda_i) = \alpha + \beta*x\), then presence/absence data at the 
site can be modeled as \(Z_i ~ Binomial(\psi_i)\) where 
\(cloglog(\psi_i) = \alpha + \beta*x\).</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>unmarkedFitOccu object describing the model fit.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    

<p>Kery, Marc, and J. Andrew Royle. 2016. <em>Applied Hierarchical Modeling in
  Ecology</em>, Volume 1. Academic Press.</p>
<p>MacKenzie, D. I., J. D. Nichols, G. B. Lachman, S. Droege,
  J. Andrew Royle, and C. A. Langtimm. 2002. Estimating Site Occupancy Rates
  When Detection Probabilities Are Less Than One. Ecology 83: 2248-2255.</p>
<p>MacKenzie, D. I. et al. 2006. <em>Occupancy Estimation and Modeling</em>.
  Amsterdam: Academic Press.</p>
<p>Royle, J. A. and R. Dorazio. 2008. <em>Hierarchical Modeling and Inference
  in Ecology</em>. Academic Press.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Ian Fiske</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='unmarked-package.html'>unmarked</a></code>, <code><a href='unmarkedFrameOccu.html'>unmarkedFrameOccu</a></code>,
    <code><a href='modSel.html'>modSel</a></code>, <code><a href='parboot.html'>parboot</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>frogs</span><span class='op'>)</span>
<span class='va'>pferUMF</span> <span class='op'>&lt;-</span> <span class='fu'><a href='unmarkedFrameOccu.html'>unmarkedFrameOccu</a></span><span class='op'>(</span><span class='va'>pfer.bin</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>pferUMF</span>, panels<span class='op'>=</span><span class='fl'>4</span><span class='op'>)</span>
</div><div class='img'><img src='occu-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># add some fake covariates for illustration</span>
<span class='fu'><a href='unmarkedFrame-class.html'>siteCovs</a></span><span class='op'>(</span><span class='va'>pferUMF</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>sitevar1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fu'><a href='unmarkedFrame-class.html'>numSites</a></span><span class='op'>(</span><span class='va'>pferUMF</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># observation covariates are in site-major, observation-minor order</span>
<span class='fu'><a href='unmarkedFrame-class.html'>obsCovs</a></span><span class='op'>(</span><span class='va'>pferUMF</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>obsvar1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fu'><a href='unmarkedFrame-class.html'>numSites</a></span><span class='op'>(</span><span class='va'>pferUMF</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='unmarkedFrame-class.html'>obsNum</a></span><span class='op'>(</span><span class='va'>pferUMF</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='op'>(</span><span class='va'>fm</span> <span class='op'>&lt;-</span> <span class='fu'>occu</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>obsvar1</span> <span class='op'>~</span> <span class='fl'>1</span>, <span class='va'>pferUMF</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; occu(formula = ~obsvar1 ~ 1, data = pferUMF)
#&gt; 
#&gt; Occupancy:
#&gt;  Estimate   SE     z P(&gt;|z|)
#&gt;      8.05 20.4 0.394   0.694
#&gt; 
#&gt; Detection:
#&gt;             Estimate    SE       z  P(&gt;|z|)
#&gt; (Intercept)   -1.929 0.164 -11.730 8.90e-32
#&gt; obsvar1       -0.152 0.177  -0.864 3.88e-01
#&gt; 
#&gt; AIC: 262.5825 </div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>fm</span>, type<span class='op'>=</span><span class='st'>'det'</span>, method <span class='op'>=</span> <span class='st'>'normal'</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                 0.025     0.975
#&gt; p(Int)     -2.2507318 -1.606287
#&gt; p(obsvar1) -0.4984393  0.193446</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>fm</span>, type<span class='op'>=</span><span class='st'>'det'</span>, method <span class='op'>=</span> <span class='st'>'profile'</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Profiling parameter 1 of 2 ... done.
#&gt; Profiling parameter 2 of 2 ... done.</div><div class='output co'>#&gt;                 0.025      0.975
#&gt; p(Int)     -2.2650988 -1.5736092
#&gt; p(obsvar1) -0.5010324  0.1933641</div><div class='input'>
<span class='co'># estimate detection effect at obsvars=0.5</span>
<span class='op'>(</span><span class='va'>lc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='linearComb-methods.html'>linearComb</a></span><span class='op'>(</span><span class='va'>fm</span><span class='op'>[</span><span class='st'>'det'</span><span class='op'>]</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Linear combination(s) of Detection estimate(s)
#&gt; 
#&gt;  Estimate    SE (Intercept) obsvar1
#&gt;        -2 0.194           1     0.5
#&gt; </div><div class='input'>
<span class='co'># transform this to probability (0 to 1) scale and get confidence limits</span>
<span class='op'>(</span><span class='va'>btlc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='backTransform-methods.html'>backTransform</a></span><span class='op'>(</span><span class='va'>lc</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Backtransformed linear combination(s) of Detection estimate(s)
#&gt; 
#&gt;  Estimate     SE LinComb (Intercept) obsvar1
#&gt;     0.119 0.0203      -2           1     0.5
#&gt; 
#&gt; Transformation: logistic </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>btlc</span>, level <span class='op'>=</span> <span class='fl'>0.9</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        0.05      0.95
#&gt;  0.08915656 0.1563634</div><div class='input'>
<span class='co'># Empirical Bayes estimates of proportion of sites occupied</span>
<span class='va'>re</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ranef-methods.html'>ranef</a></span><span class='op'>(</span><span class='va'>fm</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='unmarkedRanef-class.html'>bup</a></span><span class='op'>(</span><span class='va'>re</span>, stat<span class='op'>=</span><span class='st'>"mode"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 130</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://chandlerlab.uga.edu/richard-chandler-phd/'>Richard Chandler</a>, <a href='https://kenkellner.com'>Ken Kellner</a>, Ian Fiske, David Miller, Andy Royle, Jeff Hostetler, Rebecca Hutchinson, Adam Smith.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


