<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Conduct a power analysis on an unmarked model — powerAnalysis • unmarked</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Conduct a power analysis on an unmarked model — powerAnalysis" />
<meta property="og:description" content="This function uses a simulation-based approach to estimate power for parameters 
in unmarked models. At a minimum, users must provide a fitted unmarked model object
(preferably fit with simulated data) which ensures the model has been properly
specified, a list of effect sizes for each parameter in the model (coefs), 
and the desired Type I error (alpha). It is also possible to get power
for a range of other sample sizes besides the sample size in the fitted
model object using the design argument to subsample within the
provided dataset. See the unmarkedPower vignette for more details and
examples." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">unmarked</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1.9020</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rbchan/unmarked/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Conduct a power analysis on an unmarked model</h1>
    
    <div class="hidden name"><code>powerAnalysis.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function uses a simulation-based approach to estimate power for parameters 
in unmarked models. At a minimum, users must provide a fitted <code>unmarked</code> model object
(preferably fit with simulated data) which ensures the model has been properly
specified, a list of effect sizes for each parameter in the model (<code>coefs</code>), 
and the desired Type I error (<code>alpha</code>). It is also possible to get power
for a range of other sample sizes besides the sample size in the fitted
model object using the <code>design</code> argument to subsample within the
provided dataset. See the <code>unmarkedPower</code> vignette for more details and
examples.</p>
    </div>

    <pre class="usage"><span class='fu'>powerAnalysis</span><span class='op'>(</span><span class='va'>object</span>, coefs<span class='op'>=</span><span class='cn'>NULL</span>, design<span class='op'>=</span><span class='cn'>NULL</span>, alpha<span class='op'>=</span><span class='fl'>0.05</span>, nulls<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
                datalist<span class='op'>=</span><span class='cn'>NULL</span>, 
                nsim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>datalist</span><span class='op'>)</span>, <span class='fl'>100</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>datalist</span><span class='op'>)</span><span class='op'>)</span>, 
                parallel<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A fitted model inheriting class <code>unmarkedFit</code>. This
    could potentially be fit using real data, but ideally you would simulate
    an appropriate dataset using <code>simulate</code></p></td>
    </tr>
    <tr>
      <th>coefs</th>
      <td><p>A list containing the desired effect sizes for which you want
    to estimate power. This list must follow a specific format. There is one
    named entry in the list per submodel (e.g., occupancy, detection). To
    get the required submodel names call <code><a href='https://rdrr.io/pkg/raster/man/names.html'>names(object)</a></code> on your fitted model.
    Then, each list entry is a named vector with the names corresponding to the
    parameter names for that submodel, and the values corresponding to the 
    desired effect sizes. It may be easier to leave <code>coefs=NULL</code>, which
    will generate an error message with a template that you can fill in.</p></td>
    </tr>
    <tr>
      <th>design</th>
      <td><p>An optional list of design/sample size parameters containing 
    at a minimum two named elements: <code>M</code>, the number of sites, and <code>J</code> 
    the number of observations per site. If this list is provided, <code>unmarked</code> 
    will subsample the provided dataset to the specified number of sites and
    observations, allowing you to test power for different designs. If
    your model has multiple primary periods you must also include <code>T</code>,
    the number of periods, in the list.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Desired Type I error rate</p></td>
    </tr>
    <tr>
      <th>nulls</th>
      <td><p>If provided, a list matching the structure of <code>coefs</code> which
    defines the null hypothesis value for each parameter. By default the null
    is 0 for all parameters.</p></td>
    </tr>
    <tr>
      <th>datalist</th>
      <td><p>An optional list of previously-simulated datasets, in the form
    of <code>unmarkedFrames</code> matching the model type of <code>object</code>, which
    will be used for the power analysis simulations.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>Number of simulations to conduct</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>If <code>TRUE</code>, run folds in parallel. This may speed up 
    the power analysis in some situations</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>unmarkedPower</code> object containing the results of the power analysis</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Ken Kellner <a href='mailto:contact@kenkellner.com'>contact@kenkellner.com</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='unmarkedPowerList.html'>unmarkedPowerList</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>

<span class='co'># Simulate an occupancy dataset</span>
<span class='co'># Covariates to include in simulation</span>
<span class='va'>forms</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>state<span class='op'>=</span><span class='op'>~</span><span class='va'>elev</span>, det<span class='op'>=</span><span class='op'>~</span><span class='fl'>1</span><span class='op'>)</span>

<span class='co'># Covariate effects and intercept values</span>
<span class='va'>coefs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>state<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>intercept<span class='op'>=</span><span class='fl'>0</span>, elev<span class='op'>=</span><span class='op'>-</span><span class='fl'>0.4</span><span class='op'>)</span>, det<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>intercept<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Study design</span>
<span class='va'>design</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>M<span class='op'>=</span><span class='fl'>300</span>, J<span class='op'>=</span><span class='fl'>8</span><span class='op'>)</span> <span class='co'># 300 sites, 8 occasions per site</span>

<span class='co'># Simulate an unmarkedFrameOccu</span>
<span class='va'>occu_umf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span><span class='op'>(</span><span class='st'>"occu"</span>, formulas<span class='op'>=</span><span class='va'>forms</span>, coefs<span class='op'>=</span><span class='va'>coefs</span>, design<span class='op'>=</span><span class='va'>design</span><span class='op'>)</span>

<span class='co'># Fit occupancy model to simulated data</span>
<span class='co'># This will contain all the model structure info powerAnalysis needs</span>
<span class='co'># The estimates from the model aren't used</span>
<span class='va'>template_model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='occu.html'>occu</a></span><span class='op'>(</span><span class='op'>~</span><span class='fl'>1</span><span class='op'>~</span><span class='va'>elev</span>, <span class='va'>occu_umf</span><span class='op'>)</span>

<span class='co'># If we run powerAnalysis without specifying coefs we'll get a template list</span>
<span class='fu'>powerAnalysis</span><span class='op'>(</span><span class='va'>template_model</span><span class='op'>)</span>

<span class='co'># Set desired effect sizes to pass to coefs</span>
<span class='va'>effect_sizes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>state<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>intercept<span class='op'>=</span><span class='fl'>0</span>, elev<span class='op'>=</span><span class='op'>-</span><span class='fl'>0.4</span><span class='op'>)</span>, det<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>intercept<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Run power analysis and look at summary</span>
<span class='op'>(</span><span class='va'>pa</span> <span class='op'>&lt;-</span> <span class='fu'>powerAnalysis</span><span class='op'>(</span><span class='va'>template_model</span>, coefs<span class='op'>=</span><span class='va'>effect_sizes</span>, alpha<span class='op'>=</span><span class='fl'>0.05</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Try a smaller sample size in the study design</span>
<span class='op'>(</span><span class='va'>pa2</span> <span class='op'>&lt;-</span> <span class='fu'>powerAnalysis</span><span class='op'>(</span><span class='va'>template_model</span>, coefs<span class='op'>=</span><span class='va'>effect_sizes</span>, alpha<span class='op'>=</span><span class='fl'>0.05</span>,
                      design<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>M<span class='op'>=</span><span class='fl'>100</span>, J<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://chandlerlab.uga.edu/richard-chandler-phd/'>Richard Chandler</a>, <a href='https://kenkellner.com'>Ken Kellner</a>, Ian Fiske, David Miller, Andy Royle, Jeff Hostetler, Rebecca Hutchinson, Adam Smith.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


